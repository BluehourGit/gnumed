<?xml version="1.0"?>

<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping.dtd">

<hibernate-mapping>

	<class 
		name="xgmed.domain.common.Unit"
		table="unit"
		discriminator-value="U"
	>

	    <id 
			name="id"
			type="long"
		>
			<generator class="hilo.long">
			</generator>
	    </id>

		<discriminator
			column="type"
			type="string"
			length="2"
		/>

        <property
	    	name="label"
            type="java.lang.String"
            column="label"
            not-null="false"
			unique="false"
		/>

<set role="toRatios"  readonly="true" lazy="true">
	<key column="fromUnit"/>
	<one-to-many class="xgmed.domain.common.ConversionRatio"/>
</set>
<set role="fromRatios"  readonly="true" lazy="true">
	<key column="toUnit"/>
	<one-to-many class="xgmed.domain.common.ConversionRatio"/>
</set>

		<subclass
			name="xgmed.domain.common.AtomicUnit"
			discriminator-value="A"
		>

<!-- JRS:FIXME - why was this self inclusion here? A mistake?		

-->	

 <bag role="compoundUnits" table="atomic_compound_unit_link" lazy="true" cascade="save-update">
    <key column="atomic_unit_id"/>
     <many-to-many  class="xgmed.domain.common.CompoundUnit" column="compound_unit_id"/>
 </bag>
 
<bag role="inverseCompoundUnits" table="inverse_atomic_compound_unit_link" lazy="true" cascade="save-update">
    <key column="atomic_unit_id"/>
     <many-to-many  class="xgmed.domain.common.CompoundUnit" column="compound_unit_id"/>
 </bag>

		</subclass>
		<subclass
			name="xgmed.domain.common.CompoundUnit"
			discriminator-value="C"
                        
		>

<!-- JRS:FIXME - why was this self inclusion here? A mistake?		

-->	

 <bag role="atomicUnits" table="atomic_compound_unit_link" lazy="true"  >
    <key column="compound_unit_id"/>
     <many-to-many  class="xgmed.domain.common.AtomicUnit" column="atomic_unit_id"/>
 </bag>
 
<bag role="inverseUnits" table="inverse_atomic_compound_unit_link" lazy="true" >
    <key column="compound_unit_id"/>
    <many-to-many  class="xgmed.domain.common.AtomicUnit" column="atomic_unit_id"/>
</bag>
  
		</subclass>

	</class>

</hibernate-mapping>
