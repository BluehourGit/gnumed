<?xml version="1.0"?>

<!DOCTYPE hibernate-mapping PUBLIC 
	"-//Hibernate/Hibernate Mapping DTD//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping.dtd">

<hibernate-mapping>

	<class 
		name="xgmed.domain.accountability.Party"
		table="party"
		discriminator-value="Y"
	>

	    <id 
			name="id"
			type="long"
		>
			<generator class="hilo.long">
			</generator>
	    </id>

		<discriminator
			column="type"
			type="string"
			length="2"
		/>

       <many-to-one
	       name="address"
		   class="xgmed.domain.accountability.Address"
		   column="address"
		   not-null="false"
		   unique="false"
		   cascade="save-update"
		   outer-join="auto"
        />

        <property
	    	name="name"
            type="java.lang.String"
            column="name"
            not-null="false"
			unique="false"
		/>

<set role="telephones" table="party_telephone_link" lazy="true" cascade="save-update">
	<key column="party_id"/>
	<many-to-many class="xgmed.domain.accountability.Telephone" column="telephone_id"/>
</set>

<set role="partyTypes" table="party_partytype_link" lazy="false" cascade="save-update">
    <key column="party_id"/>
    <many-to-many class="xgmed.domain.accountability.PartyType" column="partytype_id"/>
</set>

<set role="observations" lazy="true" cascade="all">
	<key column="subject"/>
	<one-to-many class="xgmed.domain.observation.Observation"/>
</set>

		<subclass
			name="xgmed.domain.accountability.Person"
			discriminator-value="P"
		>
        <property
	    	name="birthdate"
            type="java.util.Date"
            column="birthdate"
            not-null="false"
			unique="false"
		/>

        <property
	    	name="firstNames"
            type="java.lang.String"
            column="firstNames"
            not-null="false"
			unique="false"
		/>

        <property
	    	name="lastNames"
            type="java.lang.String"
            column="lastNames"
            not-null="false"
			unique="false"
		/>

<!-- JRS:FIXME - why was this self inclusion here? A mistake?		

-->	
		</subclass>

	</class>

</hibernate-mapping>
